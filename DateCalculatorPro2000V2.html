<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–∞—Ç</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2c 100%);
            color: #ffffff;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 600px;
            width: 100%;
            padding: 30px;
            background: rgba(40, 40, 40, 0.95);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(4px);
        }

        h1 {
            font-size: 28px;
            margin-bottom: 25px;
            color: #f39c12;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        h2 {
            font-size: 20px;
            color: #ffffff;
            margin: 20px 0 15px;
        }

        label {
            font-size: 14px;
            color: #d0d0d0;
            margin-bottom: 8px;
            display: block;
        }

        select, input[type="date"] {
            background: #333333;
            color: #ffffff;
            border: none;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        select:focus, input[type="date"]:focus {
            outline: none;
            box-shadow: 0 0 0 2px #f39c12;
            background: #3a3a3a;
        }

        button {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            width: 100%;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(243, 156, 18, 0.4);
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #f39c12;
        }

        .hidden {
            display: none;
        }

        p {
            margin: 15px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
        }

        .escalation-result {
            color: #ff6b6b;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÖ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–∞—Ç</h1>
        <label for="calculatorType">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞:</label>
        <select id="calculatorType" onchange="toggleCalculator()">
            <option value="search">–°—Ä–æ–∫ –ø–æ–∏—Å–∫–∞</option>
            <option value="return">–î–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞</option>
            <option value="storage">–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è</option>
        </select>

        <div id="searchCalculator">
            <h2>–°—Ä–æ–∫ –ø–æ–∏—Å–∫–∞</h2>
            <label>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:</label>
            <input type="date" id="searchDate">
            <div class="checkbox-container">
                <input type="checkbox" id="escalationCheck" onchange="toggleEscalation()">
                <label for="escalationCheck">–ò–¥–µ—Ç —ç—Å–∫–∞–ª–∞—Ü–∏—è</label>
            </div>
            <div id="escalationSection" class="hidden">
                <label>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–∏:</label>
                <input type="date" id="escalationDate">
            </div>
            <button onclick="calculateSearchEnd()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            <p id="searchResult" class="hidden"></p>
            <p id="escalationResult" class="escalation-result hidden"></p>
        </div>

        <div id="returnCalculator" class="hidden">
            <h2>–î–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞</h2>
            <label>–î–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:</label>
            <input type="date" id="shippingDate">
            <label>–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –ø–æ—Å—Ç–∞–≤–∫–∏:</label>
            <input type="date" id="originalDeliveryDate">
            <label>–î–∞—Ç–∞ –æ—Ç–º–µ–Ω—ã:</label>
            <input type="date" id="cancellationDate">
            <button onclick="calculateReturnDate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            <p id="returnResult" class="hidden"></p>
        </div>

        <div id="storageCalculator" class="hidden">
            <h2>–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è</h2>
            <label>–î–∞—Ç–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è:</label>
            <input type="date" id="receiptDate">
            <label>–¢–∏–ø –∑–∞–∫–∞–∑–∞:</label>
            <select id="storageType">
                <option value="final">–ö–æ–Ω–µ—á–Ω—ã–π</option>
                <option value="final_extended">–ö–æ–Ω–µ—á–Ω—ã–π –ø—Ä–æ–¥–ª–µ–≤–∞–ª–∏</option>
                <option value="returnable">–í–æ–∑–≤—Ä–∞—Ç–Ω—ã–π</option>
            </select>
            <button onclick="calculateStorageDate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            <p id="storageResult" class="hidden"></p>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            toggleCalculator();
        });

        function toggleCalculator() {
            document.getElementById("searchCalculator").classList.add("hidden");
            document.getElementById("returnCalculator").classList.add("hidden");
            document.getElementById("storageCalculator").classList.add("hidden");

            let selected = document.getElementById("calculatorType").value;
            let selectedElement = document.getElementById(selected + "Calculator");
            if (selectedElement) {
                selectedElement.classList.remove("hidden");
            }
        }

        function toggleEscalation() {
            let escalationSection = document.getElementById("escalationSection");
            escalationSection.classList.toggle("hidden");
        }

        function calculateSearchEnd() {
            let searchDate = new Date(document.getElementById("searchDate").value);
            if (isNaN(searchDate)) return;
            
            searchDate.setDate(searchDate.getDate() + 14);
            let today = new Date();
            today.setHours(0, 0, 0, 0);
            
            let timeDiff = searchDate - today;
            let daysLeft = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
            
            let resultText = "üîç –ü–æ–∏—Å–∫ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è: " + formatDate(searchDate);
            if (daysLeft >= 0) {
                resultText += `<br>‚è≥ –û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π: ${daysLeft}`;
            } else {
                resultText += `<br>‚ö†Ô∏è –°—Ä–æ–∫ –ø–æ–∏—Å–∫–∞ –∏—Å—Ç–µ–∫ ${Math.abs(daysLeft)} –¥–Ω. –Ω–∞–∑–∞–¥`;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞
            document.getElementById("searchResult").classList.remove("hidden");
            document.getElementById("searchResult").innerHTML = resultText;

            if (document.getElementById("escalationCheck").checked) {
                let escalationDate = new Date(document.getElementById("escalationDate").value);
                if (isNaN(escalationDate)) return;
                escalationDate.setDate(escalationDate.getDate() + 7);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —ç—Å–∫–∞–ª–∞—Ü–∏–∏
                document.getElementById("escalationResult").classList.remove("hidden");
                document.getElementById("escalationResult").innerHTML = "‚ö†Ô∏è –≠—Å–∫–∞–ª–∞—Ü–∏—è –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è: " + formatDate(escalationDate);
            } else {
                document.getElementById("escalationResult").classList.add("hidden");
                document.getElementById("escalationResult").innerText = "";
            }
        }

        function calculateReturnDate() {
            let shipDate = new Date(document.getElementById("shippingDate").value);
            let originalDeliveryDate = new Date(document.getElementById("originalDeliveryDate").value);
            let cancellationDate = new Date(document.getElementById("cancellationDate").value);

            if (isNaN(shipDate) || isNaN(originalDeliveryDate) || isNaN(cancellationDate)) {
                document.getElementById("returnResult").innerText = "‚ùå –û—à–∏–±–∫–∞: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞—Ç–∞!";
                document.getElementById("returnResult").classList.remove("hidden");
                return;
            }

            let D = (originalDeliveryDate - shipDate) / (1000 * 60 * 60 * 24);
            let tempDate = new Date(cancellationDate);
            tempDate.setDate(tempDate.getDate() + D);
            let returnDate = new Date(tempDate);
            let workDaysToAdd = 10;
            let workDaysAdded = 0;

            while (workDaysAdded < workDaysToAdd) {
                returnDate.setDate(returnDate.getDate() + 1);
                if (returnDate.getDay() != 0 && returnDate.getDay() != 6) {
                    workDaysAdded++;
                }
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞
            document.getElementById("returnResult").classList.remove("hidden");
            document.getElementById("returnResult").innerText = "üìÖ –°—Ä–æ–∫ –≤–æ–∑–≤—Ä–∞—Ç–∞: –î–æ " + formatDate(returnDate);
        }

        function calculateStorageDate() {
            let receiptDate = new Date(document.getElementById("receiptDate").value);
            let type = document.getElementById("storageType").value;
            if (isNaN(receiptDate)) return;
            
            let daysMap = { 'final': 7, 'final_extended': 14, 'returnable': 15 };
            receiptDate.setDate(receiptDate.getDate() + daysMap[type]);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞
            document.getElementById("storageResult").classList.remove("hidden");
            document.getElementById("storageResult").innerText = "üì¶ –ó–∞–∫–∞–∑ —É–µ–¥–µ—Ç: " + formatDate(receiptDate);
        }

        function formatDate(date) {
            let options = { day: 'numeric', month: 'long', year: 'numeric' };
            return date.toLocaleDateString('ru-RU', options);
        }
    </script>
</body>
</html>